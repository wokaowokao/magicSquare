<!DOCTYPE html>
<html>
<head>
	<title></title>
	<style type="text/css">
		.a{
			display: flex;
			width: 36px;
			margin: 2px;
		}
		.row{
			display: flex;
			flex-basis: 100%;
		}
		.container{
			display: flex;
			flex-wrap: wrap;
			background: black;
			justify-content: center;
			width: 120px;
			height: 120px;
			float: left;
			margin: 20px;
		}
		.container_bottom{
			display: flex;
			flex-wrap: wrap;
			background: black;
			justify-content: center;
			width: 120px;
			height: 120px;
			float: left;
			margin: 20px;
			margin-left: 180px;
		}
		.container_top{
			display: flex;
			justify-content: center;
			flex-wrap: wrap;
			background: black;
 
			width: 120px;
			height: 120px;
			margin: 20px;
			margin-left: 180px;
		}
		.red{
			background: red;
		}
		.blue{
			background: blue;
		}
		.yellow{
			background: yellow;
		}
		.green{
			background: green;
		}
		.white {
			background: white;
		}
		.orange {
			background: orange;
		}
		.step{
			color: blue;
		}
	</style>
	<script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/1.6.4/jquery.min.js"></script>
</head>
<body>
<div class="container_top c_5">
	<div class="row">
		<div class="a yellow">1</div><div class="a yellow">1</div><div class="a yellow">1</div>
	</div>
	<div class="row">
		<div class="a yellow">1</div><div class="a yellow">1</div><div class="a yellow">1</div>
	</div>
	<div class="row">
		<div class="a yellow">1</div><div class="a yellow">1</div><div class="a yellow">1</div>
	</div>
</div>
<div class="container c_4">
	<div class="row">
		<div class="a orange">1</div><div class="a orange">1</div><div class="a orange">1</div>
	</div>
	<div class="row">
		<div class="a orange">1</div><div class="a orange">1</div><div class="a orange">1</div>
	</div>
	<div class="row">
		<div class="a orange">1</div><div class="a orange">1</div><div class="a orange">1</div>
	</div>
</div>
<div class="container c_1">
	<div class="row">
		<div class="a blue">1</div><div class="a blue">1</div><div class="a blue">1</div>
	</div>
	<div class="row">
		<div class="a blue">1</div><div class="a blue">1</div><div class="a blue">1</div>
	</div>
	<div class="row">
		<div class="a blue">1</div><div class="a blue">1</div><div class="a blue">1</div>
	</div>
</div>
<div class="container c_2">
	<div class="row">
		<div class="a red">1</div><div class="a red">1</div><div class="a red">1</div>
	</div>
	<div class="row">
		<div class="a red">1</div><div class="a red">1</div><div class="a red">1</div>
	</div>
	<div class="row">
		<div class="a red">1</div><div class="a red">1</div><div class="a red">1</div>
	</div>
</div>
<div class="container c_3">
	<div class="row">
		<div class="a green">1</div><div class="a green">1</div><div class="a green">1</div>
	</div>
	<div class="row">
		<div class="a green">1</div><div class="a green">1</div><div class="a green">1</div>
	</div>
	<div class="row">
		<div class="a green">1</div><div class="a green">1</div><div class="a green">1</div>
	</div>
</div>
<div style="clear: both;"></div>
<div class="container_bottom c_6">
	<div class="row">
		<div class="a white">1</div><div class="a white">1</div><div class="a white">1</div>
	</div>
	<div class="row">
		<div class="a white">1</div><div class="a white">1</div><div class="a white">1</div>
	</div>
	<div class="row">
		<div class="a white">1</div><div class="a white">1</div><div class="a white">1</div>
	</div>
</div>
<div style="clear: both;"></div>
<button type="button" onclick="horizontalTurn(1)">水平1层右转(1)</button>
<button type="button" onclick="horizontalTurn(2)">水平2层右转(2)</button>
<button type="button" onclick="horizontalTurn(3)">水平3层右转(3)</button>
<button type="button" onclick="horizontalTurn(4)">水平1层左转(4)</button>
<button type="button" onclick="horizontalTurn(5)">水平2层左转(5)</button>
<button type="button" onclick="horizontalTurn(6)">水平3层左转(6)</button>
</br>
<button type="button" onclick="verticalTurn(1)">垂直1层下转(7)</button>
<button type="button" onclick="verticalTurn(2)">垂直2层下转(8)</button>
<button type="button" onclick="verticalTurn(3)">垂直3层下转(9)</button>
<button type="button" onclick="verticalTurn(4)">垂直1层上转(10)</button>
<button type="button" onclick="verticalTurn(5)">垂直2层上转(11)</button>
<button type="button" onclick="verticalTurn(6)">垂直3层上转(12)</button>
</br>
<button type="button" onclick="upset()">打乱</button>
<button type="button" onclick="goback()">后退</button>
<div class="run">第一步(黄中心归位)：<span class="step"></span><button type="button" onclick="run(1)">计算</button></div>
<div class="run">第二步(黄左白点归位)：<span class="step"></span><button type="button" onclick="run(2)">计算</button></div>
<div class="run">第二步(黄右白点归位)：<span class="step"></span><button type="button" onclick="run(3)">计算</button></div>
<div class="run">第二步(黄上白点归位)：<span class="step"></span><button type="button" onclick="run(4)">计算</button></div>
<div class="run">第二步(黄下白点归位)：<span class="step"></span><button type="button" onclick="run(5)">计算</button></div>

<div class="run">第三步(白色角点归位)：<span class="step"></span><button type="button" onclick="run(3)">计算</button></div>
<script type="text/javascript">
var arr =[];
var foo = [];
var allStep = [];
for (var i = 1; i <= 6*9; i++) {
	foo.push(i);
	if (i % 3 == 0) {
		var a = Math.ceil(i/9);
    	arr[a] = arr[a] || [];
    	arr[a].push(foo);
      	foo = [];
    }
}
function _show(){
	for (var i = 1; i <= 6; i++) {
		for (var j = 0; j < 3; j++) {
			arr[i][j].forEach(function(v,k){
				var color = getColor(v);
				var index = j*3+k+1;
				display(i,index,v,color);
			})
		}
	}
}
//v 123456  index 123456789
function display(v,index,num,color){
	index = index -1;
	//console.log(v+'_'+index+'_'+num);
	var node = $('.c_'+v).find('.a').eq(index);
	node.html(num);
	node.removeClass('white');
	node.removeClass('red');
	node.removeClass('blue');
	node.removeClass('orange');
	node.removeClass('green');
	node.removeClass('yellow');
	node.addClass(color);
}
function getColor(index){
	if(index <= 9) return 'white';
	if(index > 9 && index <= 18) return'red';
	if(index > 18 && index <= 27) return'yellow';
	if(index > 27 && index <= 36) return'orange';
	if(index > 36 && index <= 45) return'green';
	if(index > 45 && index <= 54) return'blue';
}

//垂直转
function verticalTurn(type,noAddStep){
	var foo = array = [];
	if(type > 0 && type <= 3){
		var typeNum = type - 1;
		array = [5,1,6,3];
	}else{
		var typeNum = type - 4;
		array = [6,3,5,1];
	}
	array.forEach(function(v){
		for (var i = 0; i < 3; i++) {
			foo.push(arr[v][i][typeNum]);
		}
	})
	var num = 0;
	[1,6,3,5].forEach(function(v){
		for (var i = 0; i < 3; i++) {
			arr[v][i][typeNum] = foo[num];
			num++;
		}
	})
	//转侧面
	if(type == 1){turnSurface(4,1);}
	if(type == 3){turnSurface(2,0);}
	if(type == 4){turnSurface(4,0);}
	if(type == 6){turnSurface(2,1);}
	noAddStep || allStep.push('2'+type);
	_show();
}
//水平转
function horizontalTurn(type,noAddStep){
	var foo = [];
	var n = 0;
	if(type>0 && type<=3){
		n = type-1;
		foo.push(arr[4][n]);
		foo.push(arr[1][n]);
		foo.push(arr[2][n]);
		foo.push(arr[3][n]);
	}
	if(type >3 && type<=6){
		n = type-4;
		foo.push(arr[2][n]);
		foo.push(arr[3][n]);
		foo.push(arr[4][n]);
		foo.push(arr[1][n]);	
	}		
	arr[1][n] = foo[0];
	arr[2][n] = foo[1];
	arr[3][n] = foo[2];
	arr[4][n] = foo[3];

	//转顶或底面
	if(type == 1){turnSurface(5,0);}
	if(type == 3){turnSurface(6,1);}
	if(type == 4){turnSurface(5,1);}
	if(type == 6){turnSurface(6,0);}
 	//console.log(foo);
	/*arr[5][]*/
	noAddStep || allStep.push('1'+type);
	_show();
}
//n为面编号 底部  rotationSense为1 顺时针
function turnSurface(n,rotationSense){
	var array = [arr[n][0][0],arr[n][0][1],arr[n][0][2],arr[n][1][2],arr[n][2][2],arr[n][2][1],arr[n][2][0],arr[n][1][0]];
	var foo = _turnSurface(array,rotationSense);
	
	arr[n][0][0] = foo[0];
	arr[n][0][1] = foo[1];
	arr[n][0][2] = foo[2];
	arr[n][1][2] = foo[3];
	arr[n][2][2] = foo[4];
	arr[n][2][1] = foo[5];
	arr[n][2][0] = foo[6];
	arr[n][1][0] = foo[7];
}
//type为1顺时针
function _turnSurface(arr,type){
	arr.push(arr[0],arr[1]);
	arr.unshift(arr[6],arr[7]);
	if(type) return arr.slice(0,8);
	else return arr.slice(4);
}
//output 123456
function getFaceIndex(val){
	var num = '';
	arr.forEach(function(v,k){
		v.forEach(function(v2){
			v2.forEach(function(v3){
				if(v3 == val){
					num = k;
				}
			})
		})
	})
	return num;
}
function run(type){
	if(type==1){
		var num = getFaceIndex(23);
		var val = '';
		console.log(num);
		if(num == 1){val = '2,2';}
		if(num == 2){val = '2,';}
		if(num == 3){val = '';}
		if(num == 4){val = '5,';}
		if(num == 5){val = '8,2,2';}
		if(num == 6){val = '11,2,2';}
		$('.run').eq(type-1).find('.step').html(val);
	}
	if(type==2){
		var num = getFaceIndex(23);
		var val = '';
		if(num == 1){val = '2,2';}
		if(num == 2){val = '2,';}
		if(num == 3){val = '';}
		if(num == 4){val = '5,';}
		if(num == 5){val = '8,2,2';}
		if(num == 6){val = '11,2,2';}
		$('.run').eq(type-1).find('.step').html(val);
	}
}
//打乱
function upset(){
	for (var i = 0; i < 10; i++) {
		 var val = Math.round(Math.random());
		 var num = Math.round(Math.random()*5+1);
		 if(val){
		 	horizontalTurn(num);
		 }else{
		 	verticalTurn(num);
		 }
	}
}
//后退
function goback(){
	var foo = allStep[allStep.length-1];
	if(foo.substring(0,1) == '1'){
		horizontalTurn(_goback(foo.substring(1,2)),1);
	}else{
		verticalTurn(_goback(foo.substring(1,2)),1);
	}
	allStep.pop();
}
function _goback(val){
	if(val == '1') return '4';
	if(val == '2') return '5';
	if(val == '3') return '6';
	if(val == '4') return '1';
	if(val == '5') return '2';
	if(val == '6') return '3';
}
$(function(){
	_show();
})

</script>
</body>
</html>
